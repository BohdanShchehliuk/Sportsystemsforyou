Drop database if exists SPORTCLUB;
CREATE DATABASE SPORTCLUB;

USE SPORTCLUB;

CREATE TABLE TARIFF_PLAN (
ID BIGINT NOT NULL auto_increment,
NAME VARCHAR (20) NOT NULL,
PRICE BIGINT NOT NULL,
MONTH_DURATION TIME NOT NULL,
PRIMARY KEY (ID)
);
CREATE TABLE CLIENT (
ID BIGINT NOT NULL auto_increment,
NAME VARCHAR (20) NOT NULL,
BIRTHDATE DATE NOT NULL,
TARIFFPLAN_ID BIGINT DEFAULT 1,
PRIMARY KEY (ID),
FOREIGN KEY (TARIFFPLAN_ID) REFERENCES TARIFF_PLAN(ID)
);
CREATE TABLE ACCESS_LOGS (
ID BIGINT NOT NULL AUTO_INCREMENT,
CLIENT_ID BIGINT NOT NULL,
TIME_START TIMESTAMP NOT NULL,
TIME_END TIMESTAMP,
DURATION BIGINT GENERATED ALWAYS AS (TIMESTAMPDIFF(SECOND, TIME_START, TIME_END)) STORED,
PRIMARY KEY (ID),
FOREIGN KEY (CLIENT_ID) REFERENCES CLIENT(ID)
);




INSERT INTO TARIFF_PLAN (NAME, PRICE, MONTH_DURATION)
VALUES
("BASIC", 1000, '16:00:00');

INSERT INTO CLIENT (NAME, BIRTHDATE, TARIFFPLAN_ID)
VALUES
("ME", '1988-11-11', 1);

INSERT INTO ACCESS_LOGS (ID, CLIENT_ID, TIME_START, TIME_END)
VALUES
(1,1,'2023-02-25 13:00:00','2023-02-25 13:30:10');


select * from client;
select * from access_logs;